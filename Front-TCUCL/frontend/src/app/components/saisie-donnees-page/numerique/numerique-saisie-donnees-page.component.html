<div class="main-container">
  <div class="page-title">
      <h2>Poste num√©rique</h2>
      <span class="help-icon" title="Merci de renseigner le nombre de chaque type d'√©quipements en cours d'amortissement comptable, la dur√©e d'amortissement et les √©missions de GES pr√©cises si celles-ci sont connues (via une ACV / fiche PEP par exemple)">
        <svg width="1em" height="1em" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="black"></circle>
          <rect x="11" y="10" width="2" height="6" fill="white"></rect>
          <circle cx="12" cy="8" r="1" fill="white"></circle>
        </svg>
      </span>
  </div>
  <p class="question-title">Disposez-vous de donn√©es sur le cloud ?</p>
  <label><input type="radio" name="hasCloud" [(ngModel)]="donneesCloudDisponibles" [value]="true"
                (change)="updateData()"/> Oui</label>
  <label><input type="radio" name="hasCloud" [(ngModel)]="donneesCloudDisponibles" [value]="false"
                (change)="updateData()"/> Non</label>

    <div class="card" *ngIf="donneesCloudDisponibles">
      <label for="cloudTraffic">Trafic cloud (Go)</label>
      <input id="cloudTraffic" type="number" [(ngModel)]="traficCloud" (blur)="updateData()"/>

      <label for="tipUtilisateur">TIP utilisateur</label>
      <input id="tipUtilisateur" type="number" [(ngModel)]="tipUtilisateur" (blur)="updateData()"/>

      <label for="partTrafic">Part trafic France / √âtranger (Valeur comprise entre 0 et 1)</label>
      <input id="partTrafic" type="number" [(ngModel)]="partTraficFranceEtranger" (blur)="updateData()"/>
    </div>

    <hr/>

    <details>
      <summary><strong>Ajout d‚Äôun nouvel √©quipement num√©rique</strong></summary>

      <div class="form-column">
        <label>Type d'√©quipement</label>
        <select [(ngModel)]="nouvelEquipement.equipement">
          <option *ngFor="let entry of equipementOptions" [ngValue]="entry.value">
            {{ entry.label }}
          </option>
        </select>

        <label>Quantit√©</label>
        <input type="number" [(ngModel)]="nouvelEquipement.nombre"/>

        <label>Dur√©e d‚Äôamortissement (ann√©es)</label>
        <input type="number" [(ngModel)]="nouvelEquipement.dureeAmortissement"/>

        <label>√âmissions de GES connues ?</label>
        <select [(ngModel)]="nouvelEquipement.emissionsGesPrecisesConnues">
          <option [ngValue]="false" selected>Non</option>
          <option [ngValue]="true">Oui</option>
        </select>

        <label *ngIf="nouvelEquipement.emissionsGesPrecisesConnues">√âmissions de GES r√©elles (kgCO2/√©quipement)</label>
        <input *ngIf="nouvelEquipement.emissionsGesPrecisesConnues" type="number"
               [(ngModel)]="nouvelEquipement.emissionsReellesParProduitKgCO2e"/>
      </div>

      <button type="button" (click)="ajouterEquipement()">Ajouter cet √©quipement</button>
    </details>

  <div *ngIf="equipements.length > 0" class="added-equipements">
    <h3>√âquipements enregistr√©s :</h3>
    <table class="data-table">
      <thead>
      <tr>
        <th>Type</th>
        <th>Quantit√©</th>
        <th>Amortissement</th>
        <th>GES Connus</th>
        <th>GES R√©els</th>
        <th>Ann√©e</th>
        <th></th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let equipement of equipements; let i = index">
        <td>{{ numeriqueEquipmentLabels[equipement.equipement] }}</td>
        <td>{{ equipement.nombre }}</td>
        <td>{{ equipement.dureeAmortissement }}</td>
        <td>{{ equipement.emissionsGesPrecisesConnues ? 'Oui' : 'Non' }}</td>
        <td>{{ equipement.emissionsReellesParProduitKgCO2e ?? 'N/A' }}</td>
        <td>{{ equipement.anneeAjout }}</td>
        <td><button (click)="supprimerEquipement(i)">üóëÔ∏è</button></td>
      </tr>
      </tbody>
    </table>
  </div>
  <div *ngIf="resultats" class="bottom-panel">
    <h2>R√©sultats des √©missions GES</h2>
    <table class="data-table">
      <tbody>
      <tr>
        <td>Empreinte carbone data center</td>
        <td>{{ resultats.empreinteCarboneDataCenter || 0 }} kgCO2e</td>
      </tr>
      <tr>
        <td>Empreinte carbone data center + r√©seaux</td>
        <td>{{ resultats.empreinteCarboneDataCenterEtReseaux || 0 }} kgCO2e</td>
      </tr>
      <tr>
        <td>Total num√©rique</td>
        <td>{{ resultats.totalNumerique || 0 }} kgCO2e</td>
      </tr>
      </tbody>
    </table>
  </div>
  <app-save-footer [path]="ONGLET_KEYS.Numerique" (estTermineChange)="onEstTermineChange($event)"></app-save-footer>
</div>
