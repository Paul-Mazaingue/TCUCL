#Nom de l'application
spring.application.name=tcucl

# Charge le fichier .env situé à la racine du repo (un niveau au-dessus de Back-TCUCL)
spring.config.import=optional:file:../.env[.properties]

#Param�tre de la BDD
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/bdd}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:carbonucldata_usermaster}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:mdpusermaster}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect


#CONFIG JWT
# Utiliser ce site pour générer une key pour la prod https://jwtsecrets.com/#generator (ne pas push la key de prod évidemment)
app.JWT_KEY=${APP_JWT_KEY:change-me}
#12 hours
app.JWT_EXPIRATION_MS=${APP_JWT_EXPIRATION_MS:43200000}


# CONFIG MAIL (provider interne par défaut, fallback Gmail en option)
# Choix du provider: internal | gmail
app.mail.provider=${MAIL_PROVIDER:internal}
# Si true et que l'envoi internal échoue, on retente en Gmail
app.mail.fallback-to-gmail=${MAIL_FALLBACK_TO_GMAIL:true}

# Configuration interne 
app.mail.internal.host=${MAIL_INTERNAL_HOST:10.240.0.17}
app.mail.internal.port=${MAIL_INTERNAL_PORT:25}
# local-part uniquement, le domaine est imposé (@univ-catholille.fr)
app.mail.internal.localpart=${MAIL_INTERNAL_LOCALPART:TCUCL-no-reply}

# Configuration Gmail 
app.mail.gmail.host=${MAIL_GMAIL_HOST:${SPRING_MAIL_HOST:smtp.gmail.com}}
app.mail.gmail.port=${MAIL_GMAIL_PORT:${SPRING_MAIL_PORT:587}}
app.mail.gmail.username=${MAIL_GMAIL_USERNAME:${SPRING_MAIL_USERNAME:}}
app.mail.gmail.password=${MAIL_GMAIL_PASSWORD:${SPRING_MAIL_PASSWORD:}}
app.mail.gmail.from=${MAIL_GMAIL_FROM:${spring.mail.username:${SPRING_MAIL_USERNAME:}}}
app.mail.gmail.starttls=${MAIL_GMAIL_STARTTLS:true}
app.mail.gmail.auth=${MAIL_GMAIL_AUTH:true}
spring.mail.verify.host=${SPRING_MAIL_VERIFY_HOST:http://localhost:9000}

# Email superadmin (bootstrap). Fallback: spring.mail.username puis valeur legacy.
app.superadmin.email=${SUPERADMIN_EMAIL:}

# Password reset
app.reset-password.url=${FRONT_ORIGIN:http://localhost:4200}/reset-password
app.reset-password.token-validity-seconds=${APP_RESET_PASSWORD_TOKEN_VALIDITY_SECONDS:600}
app.reset-password.rate-limit-per-user=${APP_RESET_PASSWORD_RATE_LIMIT_PER_USER:5}
app.reset-password.rate-limit-per-ip=${APP_RESET_PASSWORD_RATE_LIMIT_PER_IP:500}
app.reset-password.rate-limit-window-minutes=${APP_RESET_PASSWORD_RATE_LIMIT_WINDOW_MINUTES:60}

app.dev-mode=${DEV_MODE:false}

# CONFIG SWAGGER
# http://localhost:8080/swagger-ui/index.html
springdoc.swagger-ui.path=/index.html
#lien du fichier texte pour import dans Postman ou Bruno
#http://localhost:8080/v3/api-docs

# Autorisation CORS dynamique (origine front)
# Utilise d'abord FRONT_ORIGIN si défini, sinon API_BASE_URL, sinon http://localhost:4200
app.cors.allowed-origin=${FRONT_ORIGIN:${API_BASE_URL:http://localhost:4200}}